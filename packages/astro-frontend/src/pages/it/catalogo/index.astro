---
import Layout from '../../../layouts/Layout.astro'
import { Button, Icon, Section } from 'design-react-kit'
import SuggestionSection from '../../../components/shared/SuggestionSection.astro'
import PageHero from '..//../../components/shared/PageHero.astro'
import { useCatalogTranslations } from '../../../i18n/catalog.i18n'
import { getLangFromUrl } from '../../../i18n/utils.i18n'

import { EServiceCatalogApp } from '../../../components/EServiceCatalog/EServiceCatalogApp'
import { sqlService } from '../../../server/services'

const currentLocale = getLangFromUrl(Astro.url.pathname)
const t = useCatalogTranslations(currentLocale)

const eservicesList = await sqlService.searchCatalog({
  q: '',
  limit: 12,
  offset: 0,
})
---

<div class="start">
  <Layout>
    <PageHero
      title={t('title')}
      description={t('description')}
      breadcrumbItems={[
        {
          routeKey: 'HOME',
        },
        {
          routeKey: 'ESERVICE_CATALOG',
          current: true,
        },
      ]}
    />
    <Section color="muted">
      <EServiceCatalogApp
        client:only="react"
        totalCount={eservicesList.total}
        initialEservices={eservicesList.items}
      />
    </Section>

    <div class="p-5">
      <div class="primary-bg-c1 p-5">
        <h3>{t('finder.title')}</h3>
        <div class="d-flex flex-row">
          <div class="me-2">
            <Button color="primary" outline size="sm" onClick={(): void => {}} icon
              >{t('finder.api.label')} <Icon color="white" icon="it-arrow-right" /></Button
            >
          </div>
          <Button color="primary" outline size="sm" onClick={(): void => {}} icon
            >{t('finder.provider.label')} <Icon color="white" icon="it-arrow-right" /></Button
          >
        </div>
      </div>
    </div>

    <SuggestionSection />
  </Layout>
</div>
