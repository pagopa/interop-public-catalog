---
import {
  CATALOG_API_SECTION_NAV_ITEMS,
  links,
  RESOURCES_SECTION_NAV_ITEMS,
} from '../../config/constants'
import type { SupportedLanguage } from '../../i18n/types.i18n'
import { useUiTranslations } from '../../i18n/ui.i18n'
import { getLangFromUrl, getLocalizedRoute } from '../../i18n/utils.i18n'

const currentLocale = getLangFromUrl(Astro.url.pathname)
const tUi = useUiTranslations(currentLocale)

// Footer small print links (legal, privacy, accessibility, etc.)
const footerSmallPrintLinks = [
  {
    label: tUi('footer.nav_section.media_policy'),
    getHref: (locale: SupportedLanguage) => getLocalizedRoute(locale, 'ESERVICE_CATALOG'),
  },
  {
    label: tUi('footer.nav_section.legal_notes'),
    getHref: (locale: SupportedLanguage) => getLocalizedRoute(locale, 'LEGAL_NOTES'),
  },
  {
    label: tUi('footer.nav_section.privacy_policy'),
    getHref: (locale: SupportedLanguage) => getLocalizedRoute(locale, 'PRIVACY_POLICY'),
  },
  {
    label: tUi('footer.nav_section.sitemap'),
    getHref: (_locale: SupportedLanguage) => '/sitemap.xml',
  },
  {
    label: tUi('footer.nav_section.accessibility_statement'),
    getHref: (_locale: SupportedLanguage) => '#',
  },
] as const
---

<footer class="it-footer">
  <!-- Main footer section: logos and navigation -->
  <div class="it-footer-main it-footer-small-prints">
    <div class="container pb-3">
      <section>
        {/* Logos and navigation columns */}
        <div class="row g-4">
          <div class="col-12 col-md-2 pb-2">
            <a href={links.ueCommissionLink} target="_blank">
              <img
                src="/img/next-generation-eu-footer-logo.svg"
                alt="Next Generation EU logo"
                class="img-fluid"
              />
            </a>
          </div>
          <div class="col-12 col-md-3 pb-2">
            <a href={links.dtdLink} target="_blank">
              <img
                src="/img/dtd-footer-logo.svg"
                alt="Dipartimento per la trasformazione digitale logo"
                class="img-fluid"
              />
            </a>
          </div>
          <div class="col-12 col-md-2 pb-2">
            <a href={links.pagoPaLink} target="_blank">
              <img src="/img/pagopa-footer-logo.svg" alt="PagoPA logo" class="img-fluid" />
            </a>
          </div>
          <div class="d-none d-md-flex col-12 col-md-5 pb-2 justify-content-end gap-5">
            <!-- Catalogo API links column -->
            <div>
              <h4 class="text-uppercase">
                {tUi('brand.title')}
              </h4>
              <div class="link-list-wrapper">
                <ul class="footer-list link-list clearfix">
                  {
                    CATALOG_API_SECTION_NAV_ITEMS.map((item) => (
                      <li>
                        <a class="list-item" href={item.getHref(currentLocale)}>
                          {tUi(item.i18nKey)}
                        </a>
                      </li>
                    ))
                  }
                </ul>
              </div>
            </div>
            <!-- Resources links column -->
            <div>
              <h4>
                {tUi('footer.nav_section.resources')}
              </h4>
              <div class="link-list-wrapper">
                <ul class="footer-list link-list clearfix">
                  {
                    RESOURCES_SECTION_NAV_ITEMS.map((item) => (
                      <li>
                        <a class="list-item" href={item.getHref(currentLocale)}>
                          {tUi(item.i18nKey)}
                        </a>
                      </li>
                    ))
                  }
                </ul>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>
  <!-- Small print section: legal and accessibility links -->
  <div class="it-footer-small-prints clearfix border-top border-secondary">
    <div class="container">
      <ul class="it-footer-small-prints-list list-inline mb-0 d-flex flex-column flex-md-row">
        {
          footerSmallPrintLinks.map((link) => (
            <li class="list-inline-item">
              <a href={link.getHref(currentLocale)}>{link.label}</a>
            </li>
          ))
        }
      </ul>
    </div>
  </div>
</footer>
